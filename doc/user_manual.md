# PGaugeReader 操作手册

## 版本信息
- **软件版本**: 1.0.0
- **文档版本**: 1.0
- **更新日期**: 2025年1月
- **适用人群**: 实验室技术员、操作人员

---

## 1. 快速入门

### 1.1 软件简介

PGaugeReader 是一款专业的千分表数据读取软件，专为实验室测量环境设计。软件具有以下主要功能：

- 🔗 **自动设备检测** - 智能识别千分表设备和最佳通信参数
- 📊 **实时数据显示** - 图表和数据表格同步显示测量结果
- 💾 **多格式导出** - 支持CSV、Excel等格式的数据导出
- ⚡ **高速采集** - 支持高达50Hz的数据采集频率
- 🎯 **一键清零** - 设备清零和数据清空功能

### 1.2 需要准备的设备

在开始使用前，请确保你有以下设备：

#### 必需设备
1. **千分表**（带485转接盒的数字千分表）
   - 推荐采购链接：http://item.taobao.com/item.htm?id=776845322154

2. **USB转485转换器**
   - 推荐型号：https://e.tb.cn/h.hNHACJDLXxLFNsM?tk=4VEJ4frRjQk
   - 任何标准USB转485转换器都可以使用

3. **计算机**
   - Windows 10 或更高版本
   - 至少1个USB接口

#### 可选设备
- USB延长线（如果需要远距离连接）
- 485通信线缆（部分转换器需要单独购买）

### 1.3 五分钟上手指南

**第1步**：连接硬件
- 将千分表的485接口连接到USB转485转换器
- 将转换器插入计算机USB接口

**第2步**：安装软件
- 运行 `PGaugeReader_Setup.exe`
- 按提示完成安装

**第3步**：启动软件
- 双击桌面上的PGaugeReader图标
- 或从开始菜单启动

**第4步**：连接设备
- 点击"自动检测"按钮
- 等待检测完成后点击"连接"

**第5步**：开始测量
- 点击"单次读取"进行测试
- 点击"开始连续读取"进行连续测量

🎉 **恭喜！** 你已经成功完成了基本设置，可以开始使用了！

---

## 2. 硬件连接

### 2.1 设备连接示意图

```
千分表 ←→ 485转接盒 ←→ USB转485转换器 ←→ 计算机USB接口
  📏        📦           🔌              💻
```

### 2.2 分步连接指南

#### 步骤1：连接485转接盒到千分表
1. 找到千分表上的数据接口（通常在侧面或背面）
2. 将485转接盒的连接线插入千分表接口
3. 确保连接牢固，避免松动

#### 步骤2：连接USB转485转换器
1. 找到485转接盒上的4个接线端子：
   - **RS485-A**: 485通信正极
   - **RS485-B**: 485通信负极  
   - **GND**: 地线
   - **24V**: 电源（如果需要外部供电）

2. 按照以下方式连接转换器：
   ```
   转换器端子    ←→    转接盒端子
   485+  (A)     ←→    RS485-A
   485-  (B)     ←→    RS485-B  
   GND           ←→    GND
   ```

#### 步骤3：连接到计算机
1. 将USB转485转换器插入计算机USB接口
2. 等待Windows自动识别设备
3. 如果需要，安装转换器驱动程序

### 2.3 连接验证方法

连接完成后，通过以下方法验证连接是否正确：

#### 方法1：通过设备管理器检查
1. 右键点击"此电脑" → "管理" → "设备管理器"
2. 展开"端口(COM和LPT)"
3. 应该能看到类似"USB-SERIAL CH340 (COM3)"的设备

#### 方法2：通过软件自动检测
1. 启动PGaugeReader软件
2. 点击"自动检测"按钮
3. 如果连接正确，软件会显示检测成功信息

#### 常见连接问题
- **设备管理器中无COM端口**：USB转485转换器驱动未安装
- **自动检测失败**：检查485接线是否正确
- **读取数据失败**：确认千分表电源是否开启

---

## 3. 软件安装与启动

### 3.1 系统要求

#### 最低系统要求
- **操作系统**: Windows 10 (64位)
- **内存**: 4GB RAM
- **存储空间**: 500MB 可用磁盘空间
- **其他**: .NET Framework 4.7.2 或更高版本

#### 推荐系统配置
- **操作系统**: Windows 11 (64位)
- **内存**: 8GB RAM 或更高
- **存储空间**: 2GB 可用磁盘空间

### 3.2 驱动安装

#### USB转485转换器驱动
大多数现代转换器支持即插即用，如果遇到问题：

1. **自动安装（推荐）**
   - 插入转换器后等待Windows自动安装
   - 查看设备管理器确认安装成功

2. **手动安装**
   - 在软件菜单中选择"帮助" → "安装USB驱动"
   - 或访问转换器制造商网站下载驱动

3. **验证安装**
   - 打开设备管理器
   - 在"端口"下应能看到COM端口设备

### 3.3 软件安装

#### 安装步骤
1. **获取安装程序**
   - 从提供的链接下载 `PGaugeReader_Setup.exe`
   - 或从U盘/光盘复制安装文件

2. **运行安装程序**
   - 双击 `PGaugeReader_Setup.exe`
   - 如果出现安全警告，点击"更多信息" → "仍要运行"

3. **按照向导安装**
   - 选择安装路径（建议使用默认路径）
   - 选择是否创建桌面快捷方式
   - 点击"安装"开始安装过程

4. **完成安装**
   - 安装完成后选择"启动PGaugeReader"
   - 或稍后从桌面/开始菜单启动

#### 首次启动
1. 双击桌面上的PGaugeReader图标
2. 软件会自动扫描可用串口
3. 状态栏显示"就绪 - 请选择串口并连接设备"

---

## 4. 软件操作指南

### 4.1 界面介绍

软件主界面分为以下几个区域：

#### 左侧控制面板
- **通信设置区域**
  - 串口选择下拉框
  - 波特率设置（通常使用9600）
  - 读取间隔设置（默认0.2秒）

- **操作按钮区域**
  - "自动检测"：自动检测设备和最佳波特率
  - "连接"：连接或断开设备
  - "单次读取"：进行一次数据读取
  - "开始连续读取"：开始连续数据采集
  - "清零"：设备清零和数据清空

#### 右侧数据显示区域
- **图表标签页**：实时数据曲线图
- **数据标签页**：数据记录表格

#### 底部状态栏
显示当前连接状态和操作提示信息

### 4.2 设备连接设置

#### 自动连接（推荐方式）
1. **自动检测设备**
   - 确保硬件连接正确
   - 点击"自动检测"按钮
   - 等待软件扫描所有可用端口和波特率
   - 检测成功后会显示结果对话框

2. **选择检测结果**
   - 如果检测成功，选择"使用自动设置"
   - 软件会自动配置最佳参数

3. **连接设备**
   - 点击"连接"按钮
   - 连接成功后按钮变为"断开"
   - 状态栏显示连接信息

#### 手动连接
如果自动检测失败，可以手动设置：

1. **选择串口**
   - 从串口下拉框中选择正确的COM端口
   - 通常是COM3、COM4等

2. **设置波特率**
   - 新设备通常使用9600
   - 如果连接失败，可尝试其他波特率

3. **点击连接**
   - 连接成功后所有操作按钮变为可用状态

### 4.3 数据读取操作

#### 单次读取
用于测试连接或获取当前位置数据：

1. 确保设备已连接
2. 点击"单次读取"按钮
3. 在弹出的对话框中查看读取结果
4. 对话框显示：
   - 当前测量值（单位：毫米）
   - 连接信息（串口、波特率）
   - 读取时间

#### 连续读取
用于持续监测和数据记录：

1. **设置读取间隔**
   - 在"读取间隔"框中设置间隔时间
   - 默认0.2秒（每秒5次）
   - 可设置范围：0.001-10.0秒

2. **开始连续读取**
   - 点击"开始连续读取"按钮
   - 按钮文字变为"停止读取"
   - 数据开始实时显示在图表和表格中

3. **监控数据**
   - 图表显示数据变化趋势
   - 表格记录每次测量的具体数值和时间
   - 状态栏显示当前读取状态

4. **停止读取**
   - 点击"停止读取"按钮
   - 数据采集停止，已采集的数据保留

#### 读取间隔优化
软件会自动验证读取间隔设置：

- **间隔过小时**会显示警告对话框
- 可选择"使用建议波特率"提高速度
- 或选择"调整为最小间隔"保持当前波特率

### 4.4 数据导出功能

#### 导出格式
软件支持多种数据导出格式：

- **CSV格式**：适用于Excel和其他数据分析软件
- **Excel格式**：直接生成Excel文件，包含统计信息
- **数据库格式**：SQLite数据库，适合程序处理

#### 导出操作步骤

**导出CSV文件**：
1. 在菜单栏点击"文件" → "保存为..." → "CSV"
2. 选择保存位置和文件名
3. 点击"保存"完成导出

**导出Excel文件**：
1. 在菜单栏点击"文件" → "保存为..." → "Excel"
2. 选择保存位置和文件名
3. 导出的Excel文件包含两个工作表：
   - "千分表数据"：详细的测量记录
   - "统计信息"：数据统计分析

**导出数据库文件**：
1. 在菜单栏点击"文件" → "保存为..." → "Access"
2. 实际导出为SQLite格式数据库
3. 可使用DB Browser等工具打开

#### 导出数据格式说明
所有导出文件都包含以下信息：
- **时间**：精确到毫秒的测量时间
- **数值**：测量结果（单位：毫米）
- **统计信息**：最大值、最小值、平均值等

### 4.5 设备清零操作

#### 什么时候需要清零
- 开始新的测量项目时
- 需要将当前位置设置为零点时
- 数据异常需要重新开始时

#### 清零操作步骤
1. **停止连续读取**（如果正在进行）
2. 点击"清零"按钮
3. 在确认对话框中查看将要执行的操作：
   - 设备清零归位
   - 清空已记录的数据
4. 点击"确认清零"执行操作
5. 等待操作完成提示

#### 注意事项
- 清零操作不可撤销
- 会同时清空设备零点和软件中的所有数据
- 建议在清零前导出重要数据

---

## 5. 常见问题解答

### 5.1 连接问题

#### Q: 软件找不到串口设备？
**A**: 请检查以下几点：
- USB转485转换器是否正确插入
- 驱动程序是否正确安装
- 在设备管理器中查看是否有COM端口
- 尝试重新插拔USB设备

#### Q: 自动检测失败？
**A**: 可能的原因和解决方法：
- **485接线错误**：检查A、B线是否接反
- **设备未通电**：确认千分表电源开启
- **通信干扰**：远离强电磁干扰源
- **设备故障**：尝试手动设置不同波特率

#### Q: 连接成功但无法读取数据？
**A**: 请尝试以下方法：
- 检查设备是否正常工作（显示屏有显示）
- 尝试不同的波特率设置
- 重新连接所有硬件接口
- 联系技术支持

### 5.2 读取问题

#### Q: 数据读取不稳定？
**A**: 优化建议：
- 增大读取间隔（如改为0.5秒）
- 提高波特率到19200或更高
- 检查485连接线是否牢固
- 避免在读取时移动设备

#### Q: 读取速度太慢？
**A**: 提升速度的方法：
- 使用更高的波特率（38400、57600）
- 减小读取间隔
- 使用质量更好的USB转485转换器
- 确保USB接口供电充足

#### Q: 数据异常或跳变？
**A**: 排查步骤：
- 检查千分表机械部分是否正常
- 确认测量环境稳定（无振动）
- 重新校准设备零点
- 检查电气连接是否可靠

### 5.3 软件问题

#### Q: 软件启动缓慢或卡顿？
**A**: 性能优化：
- 关闭不必要的后台程序
- 确保系统内存充足
- 定期清理数据记录
- 重启软件和计算机

#### Q: 图表显示异常？
**A**: 解决方法：
- 点击图表上的"清空图表"按钮
- 调整时间范围显示设置
- 重启软件重新连接设备
- 检查系统显示设置

#### Q: 数据导出失败？
**A**: 可能原因：
- 磁盘空间不足
- 文件正在被其他程序使用
- 没有写入权限
- 选择有效的保存路径

### 5.4 获取技术支持

如果以上方法都无法解决问题，请联系技术支持：

**QQ技术支持**: 2975972646

联系时请提供：
- 软件版本号
- 操作系统版本
- 具体错误信息
- 问题重现步骤

---

## 6. 注意事项与维护

### 6.1 使用注意事项

#### 硬件使用
- **轻拿轻放**：千分表是精密仪器，避免剧烈冲击
- **保持清洁**：定期清理设备表面和连接接口
- **避免过载**：不要超出千分表的测量范围
- **防止进水**：在潮湿环境中注意防护

#### 软件使用
- **及时保存**：重要数据及时导出保存
- **定期备份**：建立数据备份制度
- **稳定环境**：避免在系统负载很高时进行精密测量
- **正确关闭**：测量完成后正确断开连接并关闭软件

### 6.2 维护建议

#### 日常维护
- 每次使用前检查硬件连接
- 定期校验设备精度
- 清理软件数据记录
- 更新驱动程序

#### 定期维护
- 每月检查USB接口和连接线
- 每季度对设备进行全面检查
- 年度精度校准和维护

### 6.3 故障预防

#### 预防措施
- 使用稳定的电源供应
- 保持良好的工作环境
- 建立设备使用记录
- 培训操作人员正确使用

#### 应急处理
- 准备备用USB转485转换器
- 保存软件安装文件和驱动
- 建立问题处理流程
- 记录故障现象和解决方法

---

## 附录

### 技术参数
- **测量精度**：取决于千分表本身精度
- **通信协议**：Modbus RTU over RS485
- **支持波特率**：2400-115200 bps
- **最大采样频率**：50 Hz（波特率115200时）
- **数据格式**：32位有符号整数，精度0.0001mm

### 更新记录
- **v1.0.0** (2025-01): 初始版本发布

---

*© 2025 PGaugeReader. 技术支持：QQ 2975972646*